{"remainingRequest":"C:\\Users\\Monya\\Desktop\\my-project\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Monya\\Desktop\\my-project\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\Monya\\Desktop\\my-project\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Monya\\Desktop\\my-project\\src\\views\\book\\BookModifyPage.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Monya\\Desktop\\my-project\\src\\views\\book\\BookModifyPage.vue","mtime":1556525649259},{"path":"C:\\Users\\Monya\\Desktop\\my-project\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1555329071562},{"path":"C:\\Users\\Monya\\Desktop\\my-project\\node_modules\\babel-loader\\lib\\index.js","mtime":1555329027271},{"path":"C:\\Users\\Monya\\Desktop\\my-project\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1555329071562},{"path":"C:\\Users\\Monya\\Desktop\\my-project\\node_modules\\vue-loader\\lib\\index.js","mtime":1555329073101}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\nimport _toConsumableArray from \"C:\\\\Users\\\\Monya\\\\Desktop\\\\my-project\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/toConsumableArray\";\nimport \"core-js/modules/es6.number.constructor\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { updateBookById } from '../../api/book';\nimport { getBookById } from '../../api/book';\nimport reqwest from 'reqwest';\n\nfunction getBase64(img, callback) {\n  var reader = new FileReader();\n  reader.addEventListener('load', function () {\n    return callback(reader.result);\n  });\n  reader.readAsDataURL(img);\n}\n\nexport default {\n  name: 'BookModifyPage',\n  data: function data() {\n    return {\n      description: '图书修改页',\n      value: 1,\n      // form\n      form: this.$form.createForm(this),\n      book: {\n        bookid: 1\n      },\n      fileList: [],\n      uploading: false\n    };\n  },\n  mounted: function mounted() {\n    this.fetchData();\n  },\n  methods: {\n    fetchData: function fetchData() {\n      var _this = this;\n\n      getBookById(this.$route.params.id).then(function (res) {\n        var data = res.result.data;\n        _this.book = data;\n      });\n    },\n    confirm: function confirm(e) {\n      // console.log(e)\n      this.handleSubmit(e);\n    },\n    cancel: function cancel(e) {\n      // console.log(e)\n      this.$message.warning('请重新输入');\n    },\n    // handler\n    handleSubmit: function handleSubmit(e) {\n      var _this2 = this;\n\n      e.preventDefault();\n      var bookid = this.$route.params.id;\n      this.form.validateFields(function (err, values) {\n        if (!err) {\n          // eslint-disable-next-line no-console\n          console.log('Received values of form: ', values);\n          updateBookById(bookid, values).then(function (res) {\n            console.log('res::', res);\n            console.log(Number(res.result.bookid) == bookid);\n\n            if (Number(res.result.bookid) == bookid) {\n              _this2.$message.success('修改成功');\n\n              _this2.$router.push({\n                name: 'BookDetailPage',\n                params: {\n                  id: bookid\n                }\n              }); // 修改成功后跳转到详情页\n\n            } else {\n              _this2.$message.error('修改失败');\n            }\n          });\n        }\n      });\n    },\n    handleRemove: function handleRemove(file) {\n      var index = this.fileList.indexOf(file);\n      var newFileList = this.fileList.slice();\n      newFileList.splice(index, 1);\n      this.fileList = newFileList;\n    },\n    beforeUpload: function beforeUpload(file) {\n      this.fileList = [].concat(_toConsumableArray(this.fileList), [file]);\n      return false;\n    },\n    handleUpload: function handleUpload() {\n      var _this3 = this;\n\n      var fileList = this.fileList;\n      var formData = new FormData();\n      fileList.forEach(function (file) {\n        formData.append('files[]', file);\n      });\n      this.uploading = true; // You can use any AJAX library you like\n\n      reqwest({\n        url: '//jsonplaceholder.typicode.com/posts/',\n        method: 'post',\n        processData: false,\n        data: formData,\n        success: function success() {\n          _this3.fileList = [];\n          _this3.uploading = false;\n\n          _this3.$message.success('upload successfully.');\n        },\n        error: function error() {\n          _this3.uploading = false;\n\n          _this3.$message.error('upload failed.');\n        }\n      });\n    }\n  }\n};",{"version":3,"sources":["BookModifyPage.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyEA,SAAA,cAAA,QAAA,gBAAA;AACA,SAAA,WAAA,QAAA,gBAAA;AACA,OAAA,OAAA,MAAA,SAAA;;AAEA,SAAA,SAAA,CAAA,GAAA,EAAA,QAAA,EAAA;AACA,MAAA,MAAA,GAAA,IAAA,UAAA,EAAA;AACA,EAAA,MAAA,CAAA,gBAAA,CAAA,MAAA,EAAA;AAAA,WAAA,QAAA,CAAA,MAAA,CAAA,MAAA,CAAA;AAAA,GAAA;AACA,EAAA,MAAA,CAAA,aAAA,CAAA,GAAA;AACA;;AAEA,eAAA;AACA,EAAA,IAAA,EAAA,gBADA;AAEA,EAAA,IAFA,kBAEA;AACA,WAAA;AACA,MAAA,WAAA,EAAA,OADA;AAEA,MAAA,KAAA,EAAA,CAFA;AAGA;AACA,MAAA,IAAA,EAAA,KAAA,KAAA,CAAA,UAAA,CAAA,IAAA,CAJA;AAKA,MAAA,IAAA,EAAA;AAAA,QAAA,MAAA,EAAA;AAAA,OALA;AAMA,MAAA,QAAA,EAAA,EANA;AAOA,MAAA,SAAA,EAAA;AAPA,KAAA;AASA,GAZA;AAaA,EAAA,OAbA,qBAaA;AACA,SAAA,SAAA;AACA,GAfA;AAgBA,EAAA,OAAA,EAAA;AACA,IAAA,SADA,uBACA;AAAA;;AACA,MAAA,WAAA,CAAA,KAAA,MAAA,CAAA,MAAA,CAAA,EAAA,CAAA,CAAA,IAAA,CAAA,UAAA,GAAA,EAAA;AACA,YAAA,IAAA,GAAA,GAAA,CAAA,MAAA,CAAA,IAAA;AACA,QAAA,KAAA,CAAA,IAAA,GAAA,IAAA;AACA,OAHA;AAIA,KANA;AAOA,IAAA,OAPA,mBAOA,CAPA,EAOA;AACA;AACA,WAAA,YAAA,CAAA,CAAA;AACA,KAVA;AAWA,IAAA,MAXA,kBAWA,CAXA,EAWA;AACA;AACA,WAAA,QAAA,CAAA,OAAA,CAAA,OAAA;AACA,KAdA;AAeA;AACA,IAAA,YAhBA,wBAgBA,CAhBA,EAgBA;AAAA;;AACA,MAAA,CAAA,CAAA,cAAA;AACA,UAAA,MAAA,GAAA,KAAA,MAAA,CAAA,MAAA,CAAA,EAAA;AACA,WAAA,IAAA,CAAA,cAAA,CAAA,UAAA,GAAA,EAAA,MAAA,EAAA;AACA,YAAA,CAAA,GAAA,EAAA;AACA;AACA,UAAA,OAAA,CAAA,GAAA,CAAA,2BAAA,EAAA,MAAA;AACA,UAAA,cAAA,CAAA,MAAA,EAAA,MAAA,CAAA,CAAA,IAAA,CAAA,UAAA,GAAA,EAAA;AACA,YAAA,OAAA,CAAA,GAAA,CAAA,OAAA,EAAA,GAAA;AACA,YAAA,OAAA,CAAA,GAAA,CAAA,MAAA,CAAA,GAAA,CAAA,MAAA,CAAA,MAAA,CAAA,IAAA,MAAA;;AACA,gBAAA,MAAA,CAAA,GAAA,CAAA,MAAA,CAAA,MAAA,CAAA,IAAA,MAAA,EAAA;AACA,cAAA,MAAA,CAAA,QAAA,CAAA,OAAA,CAAA,MAAA;;AACA,cAAA,MAAA,CAAA,OAAA,CAAA,IAAA,CAAA;AAAA,gBAAA,IAAA,EAAA,gBAAA;AAAA,gBAAA,MAAA,EAAA;AAAA,kBAAA,EAAA,EAAA;AAAA;AAAA,eAAA,EAFA,CAEA;;AACA,aAHA,MAGA;AACA,cAAA,MAAA,CAAA,QAAA,CAAA,KAAA,CAAA,MAAA;AACA;AACA,WATA;AAUA;AACA,OAfA;AAgBA,KAnCA;AAoCA,IAAA,YApCA,wBAoCA,IApCA,EAoCA;AACA,UAAA,KAAA,GAAA,KAAA,QAAA,CAAA,OAAA,CAAA,IAAA,CAAA;AACA,UAAA,WAAA,GAAA,KAAA,QAAA,CAAA,KAAA,EAAA;AACA,MAAA,WAAA,CAAA,MAAA,CAAA,KAAA,EAAA,CAAA;AACA,WAAA,QAAA,GAAA,WAAA;AACA,KAzCA;AA0CA,IAAA,YA1CA,wBA0CA,IA1CA,EA0CA;AACA,WAAA,QAAA,gCAAA,KAAA,QAAA,IAAA,IAAA;AACA,aAAA,KAAA;AACA,KA7CA;AA8CA,IAAA,YA9CA,0BA8CA;AAAA;;AAAA,UACA,QADA,GACA,IADA,CACA,QADA;AAEA,UAAA,QAAA,GAAA,IAAA,QAAA,EAAA;AACA,MAAA,QAAA,CAAA,OAAA,CAAA,UAAA,IAAA,EAAA;AACA,QAAA,QAAA,CAAA,MAAA,CAAA,SAAA,EAAA,IAAA;AACA,OAFA;AAGA,WAAA,SAAA,GAAA,IAAA,CANA,CAQA;;AACA,MAAA,OAAA,CAAA;AACA,QAAA,GAAA,EAAA,uCADA;AAEA,QAAA,MAAA,EAAA,MAFA;AAGA,QAAA,WAAA,EAAA,KAHA;AAIA,QAAA,IAAA,EAAA,QAJA;AAKA,QAAA,OAAA,EAAA,mBAAA;AACA,UAAA,MAAA,CAAA,QAAA,GAAA,EAAA;AACA,UAAA,MAAA,CAAA,SAAA,GAAA,KAAA;;AACA,UAAA,MAAA,CAAA,QAAA,CAAA,OAAA,CAAA,sBAAA;AACA,SATA;AAUA,QAAA,KAAA,EAAA,iBAAA;AACA,UAAA,MAAA,CAAA,SAAA,GAAA,KAAA;;AACA,UAAA,MAAA,CAAA,QAAA,CAAA,KAAA,CAAA,gBAAA;AACA;AAbA,OAAA,CAAA;AAeA;AAtEA;AAhBA,CAAA","sourcesContent":["<template>\r\n  <a-card :body-style=\"{padding: '24px 32px'}\" :bordered=\"false\">\r\n    <a-form @submit=\"handleSubmit\" :form=\"form\">\r\n      <a-form-item\r\n        label=\"图书名称\"\r\n        :labelCol=\"{lg: {span: 7}, sm: {span: 7}}\"\r\n        :wrapperCol=\"{lg: {span: 10}, sm: {span: 17} }\"\r\n      >\r\n        <a-input\r\n          v-decorator=\"[\r\n            'bookname',\r\n            {rules: [{ required: true, message: '请输入标题' }]}\r\n          ]\"\r\n          name=\"name\"\r\n          :placeholder=\"book.bookname\"\r\n        />\r\n      </a-form-item>\r\n      <a-form-item\r\n        label=\"图书风格/分类\"\r\n        :labelCol=\"{lg: {span: 7}, sm: {span: 7}}\"\r\n        :wrapperCol=\"{lg: {span: 10}, sm: {span: 17} }\"\r\n      >\r\n        <a-textarea\r\n          rows=\"4\"\r\n          :placeholder=\"book.bookstyle\"\r\n          v-decorator=\"[\r\n            'bookstyle',\r\n            {rules: [{ required: true,message:'请输入风格/分类'}]}\r\n          ]\"\r\n        />\r\n      </a-form-item>\r\n      <a-form-item\r\n        label=\"图书avatar\"\r\n        :labelCol=\"{lg: {span: 7}, sm: {span: 7}}\"\r\n        :wrapperCol=\"{lg: {span: 10}, sm: {span: 17} }\"\r\n      >\r\n        <a-input\r\n          :placeholder=\"book.avatar\"\r\n          v-decorator=\"[\r\n        'avatar',\r\n        {rules: [{ required: true, message: '请输入图书的avatar' }]}\r\n        ]\"\r\n        />\r\n      </a-form-item>\r\n\r\n      <a-form-item>\r\n        <div class=\"clearfix\">\r\n          <a-upload :fileList=\"fileList\" :remove=\"handleRemove\" :beforeUpload=\"beforeUpload\">\r\n            <a-button>\r\n              <a-icon type=\"upload\"/>Select File\r\n            </a-button>\r\n          </a-upload>\r\n          <a-button\r\n            type=\"primary\"\r\n            @click=\"handleUpload\"\r\n            :disabled=\"fileList.length === 0\"\r\n            :loading=\"uploading\"\r\n            style=\"margin-top: 16px\"\r\n          >{{uploading ? 'Uploading' : 'Start Upload' }}</a-button>\r\n        </div>\r\n      </a-form-item>\r\n\r\n      <a-form-item :wrapperCol=\"{ span: 24 }\" style=\"text-align: center\">\r\n        <a-popconfirm title=\"确定提交\" @confirm=\"confirm\" @cancel=\"cancel\" okText=\"Yes\" cancelText=\"No\">\r\n          <a-button htmlType=\"submit\" type=\"primary\">提交</a-button>\r\n        </a-popconfirm>\r\n        <!-- <a-button style=\"margin-left: 8px\">保存</a-button> -->\r\n      </a-form-item>\r\n    </a-form>\r\n  </a-card>\r\n</template>\r\n\r\n<script>\r\nimport { updateBookById } from '../../api/book'\r\nimport { getBookById } from '../../api/book'\r\nimport reqwest from 'reqwest'\r\n\r\nfunction getBase64(img, callback) {\r\n  const reader = new FileReader()\r\n  reader.addEventListener('load', () => callback(reader.result))\r\n  reader.readAsDataURL(img)\r\n}\r\n\r\nexport default {\r\n  name: 'BookModifyPage',\r\n  data() {\r\n    return {\r\n      description: '图书修改页',\r\n      value: 1,\r\n      // form\r\n      form: this.$form.createForm(this),\r\n      book: { bookid: 1 },\r\n      fileList: [],\r\n      uploading: false,\r\n    }\r\n  },\r\n  mounted() {\r\n    this.fetchData()\r\n  },\r\n  methods: {\r\n    fetchData() {\r\n      getBookById(this.$route.params.id).then(res => {\r\n        var data = res.result.data\r\n        this.book = data\r\n      })\r\n    },\r\n    confirm(e) {\r\n      // console.log(e)\r\n      this.handleSubmit(e)\r\n    },\r\n    cancel(e) {\r\n      // console.log(e)\r\n      this.$message.warning('请重新输入')\r\n    },\r\n    // handler\r\n    handleSubmit(e) {\r\n      e.preventDefault()\r\n      var bookid = this.$route.params.id\r\n      this.form.validateFields((err, values) => {\r\n        if (!err) {\r\n          // eslint-disable-next-line no-console\r\n          console.log('Received values of form: ', values)\r\n          updateBookById(bookid, values).then(res => {\r\n            console.log('res::', res)\r\n            console.log(Number(res.result.bookid) == bookid)\r\n            if (Number(res.result.bookid) == bookid) {\r\n              this.$message.success('修改成功')\r\n              this.$router.push({ name: 'BookDetailPage', params: { id: bookid } }) // 修改成功后跳转到详情页\r\n            } else {\r\n              this.$message.error('修改失败')\r\n            }\r\n          })\r\n        }\r\n      })\r\n    },\r\n    handleRemove(file) {\r\n      const index = this.fileList.indexOf(file);\r\n      const newFileList = this.fileList.slice();\r\n      newFileList.splice(index, 1);\r\n      this.fileList = newFileList\r\n    },\r\n    beforeUpload(file) {\r\n      this.fileList = [...this.fileList, file]\r\n      return false;\r\n    },\r\n    handleUpload() {\r\n      const { fileList } = this;\r\n      const formData = new FormData();\r\n      fileList.forEach((file) => {\r\n        formData.append('files[]', file);\r\n      });\r\n      this.uploading = true\r\n\r\n      // You can use any AJAX library you like\r\n      reqwest({\r\n        url: '//jsonplaceholder.typicode.com/posts/',\r\n        method: 'post',\r\n        processData: false,\r\n        data: formData,\r\n        success: () => {\r\n          this.fileList = []\r\n          this.uploading = false\r\n          this.$message.success('upload successfully.');\r\n        },\r\n        error: () => {\r\n          this.uploading = false\r\n          this.$message.error('upload failed.');\r\n        },\r\n      });\r\n    }\r\n  }\r\n}\r\n</script>\r\n"],"sourceRoot":"src/views/book"}]}